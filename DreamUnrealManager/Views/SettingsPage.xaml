<Page
    x:Class="DreamUnrealManager.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:views="using:DreamUnrealManager.Views"
    mc:Ignorable="d">

    <Grid x:Name="ContentArea">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel Margin="20" Spacing="20">

                <!-- 页面标题 -->
                <TextBlock Text="设置"
                           FontSize="28"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10" />

                <!-- 引擎管理卡片 -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="20">
                    <StackPanel Spacing="15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Unreal Engine 管理"
                                       FontSize="20"
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Center" />
                            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                                <Button Content="添加引擎"
                                        Click="AddEngine_Click"
                                        Style="{ThemeResource AccentButtonStyle}" />
                                <Button Content="自动检测"
                                        Click="AutoDetect_Click" />
                                <Button Content="刷新"
                                        Click="RefreshEngines_Click" />
                            </StackPanel>
                        </Grid>

                        <!-- 引擎列表 -->
                        <ScrollViewer Height="400"
                                      VerticalScrollBarVisibility="Auto"
                                      Background="{ThemeResource ControlFillColorTransparentBrush}"
                                      BorderBrush="{ThemeResource ControlStrokeColorDefaultBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4">
                            <StackPanel x:Name="EnginesStackPanel" Spacing="2" Margin="5" />
                        </ScrollViewer>

                        <TextBlock Text="提示: 可以手动添加自定义的 Unreal Engine 安装路径，或使用自动检测功能扫描常见的安装位置。"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   FontSize="12"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>

                <!-- 其他设置卡片 -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8"
                        Padding="20">
                    <StackPanel Spacing="15">
                        <TextBlock Text="应用设置"
                                   FontSize="20"
                                   FontWeight="SemiBold" />

                        <ToggleSwitch x:Name="AutoScanToggle"
                                      Header="启动时自动扫描引擎"
                                      IsOn="True" />

                        <ToggleSwitch x:Name="LogDetailToggle"
                                      Header="详细构建日志"
                                      IsOn="False" />

                        <NumberBox x:Name="MaxLogLinesNumber"
                                   Header="最大日志行数"
                                   Value="1000"
                                   Minimum="100"
                                   Maximum="10000"
                                   SpinButtonPlacementMode="Inline" />
                    </StackPanel>
                </Border>

                <controls:SettingsCard x:Name="ConsoleFontSettingCard"
                                       Description="控制台字体"
                                       Header="控制台字体"
                                       CornerRadius="8">

                    <ComboBox x:Name="FontCombo"
                              PlaceholderText="选择字体…"
                              ItemsSource="{x:Bind AvailableFonts}"
                              SelectionChanged="FontCombo_SelectionChanged"
                              SelectedValuePath="Name"
                              MaxDropDownHeight="420">

                        <ComboBox.ItemTemplate>
                            <DataTemplate x:DataType="views:FontOption">
                                <Grid ColumnSpacing="12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0"
                                               Text="{x:Bind Name}"
                                               VerticalAlignment="Center" />

                                    <TextBlock Grid.Column="1"
                                               Text="Aa 0123 中國汉字 かなカナ — The quick brown fox"
                                               FontFamily="{x:Bind FontFamily}"
                                               Opacity="0.9"
                                               TextTrimming="CharacterEllipsis" />
                                </Grid>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                </controls:SettingsCard>


            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>